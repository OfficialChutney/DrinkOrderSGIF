@page "/"

@inject ITeamService TeamService
@inject OrderDraftState DraftState
@inject NavigationManager Navigation

<PageTitle>Hold valg</PageTitle>

<h1>Vælg dit hold til bestilling</h1>

@if (_teams.Count == 0)
{
    <p>Ingen hold er oprettet endnu. Spørg en administrator for at oprette et hold.</p>
}
else
{
    <div class="team-grid">
        @foreach (var team in _teams)
        {
            <button class="team-button" @onclick="() => StartOrder(team)">
                @team.Name
            </button>
        }
    </div>
}

@code {
    private IReadOnlyList<Team> _teams = Array.Empty<Team>();

    protected override async Task OnInitializedAsync()
    {
        _teams = await TeamService.GetActiveTeamsAsync();
    }

    private void StartOrder(Team team)
    {
        DraftState.SetTeam(team.Id, team.Name);
        Navigation.NavigateTo($"/order/{team.Id}");
    }
}
